<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ollama API ÏÑúÎ≤Ñ - Î©îÎ™®Î¶¨ Í∏∞Îä• Ìè¨Ìï® Ï±ÑÌåÖ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 600px;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #e9ecef;
        }

        .chat-area {
            display: flex;
            flex-direction: column;
            height: 600px;
        }

        .config-section {
            margin-bottom: 30px;
        }

        .config-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #495057;
            font-weight: 500;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
        }

        .help-text {
            margin-top: 6px;
            color: #6c757d;
            font-size: 12px;
            line-height: 1.4;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .memory-stats {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .memory-stats h4 {
            color: #495057;
            margin-bottom: 10px;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .stat-value {
            font-weight: bold;
            color: #667eea;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 10px;
            max-width: 80%;
        }

        .message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
        }

        .message.assistant {
            background: white;
            border: 1px solid #e9ecef;
            color: #495057;
        }

        .message.system {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            color: #1976d2;
            font-style: italic;
            font-size: 0.9em;
        }

        .message-header {
            font-size: 0.8em;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .chat-input {
            padding: 20px;
            background: white;
            border-top: 1px solid #e9ecef;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .input-group input {
            flex: 1;
            padding: 12px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 14px;
        }

        .input-group button {
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .status {
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            font-size: 14px;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #6c757d;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background-color: #e9ecef;
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
            animation: progress-animation 2s ease-in-out infinite;
        }

        .retry-button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-size: 14px;
        }

        .retry-button:hover {
            background: #c82333;
        }

        @keyframes progress-animation {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        .memory-item {
            background: white;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            font-size: 14px;
        }

        .memory-item .timestamp {
            font-size: 0.8em;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .memory-item .content {
            color: #495057;
        }

        .emotion-breakdown {
            margin-top: 10px;
        }

        .emotion-item {
            background: #f8f9fa;
            padding: 5px 10px;
            margin: 2px 0;
            border-radius: 3px;
            font-size: 12px;
            display: inline-block;
            margin-right: 5px;
        }

        .timeline-event {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #667eea;
        }

        .event-date {
            font-weight: bold;
            color: #667eea;
            font-size: 14px;
        }

        .event-type {
            color: #6c757d;
            font-size: 12px;
            text-transform: uppercase;
        }

        .event-description {
            margin: 5px 0;
            color: #495057;
        }

        .event-emotion {
            color: #28a745;
            font-size: 12px;
        }

        .pattern-item {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }

        .pattern-topics {
            font-weight: bold;
            color: #495057;
        }

        .pattern-emotion {
            color: #6c757d;
            font-size: 12px;
        }

        .pattern-frequency {
            color: #28a745;
            font-size: 12px;
        }

        .pattern-date {
            color: #6c757d;
            font-size: 11px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            .chat-area {
                order: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="mainTitle">üß† Ollama API ÏÑúÎ≤Ñ</h1>
            <p id="subtitle">Î©îÎ™®Î¶¨ Í∏∞Îä•Ïù¥ Ìè¨Ìï®Îêú AI Ï±ÑÌåÖ Ïù∏ÌÑ∞ÌéòÏù¥Ïä§</p>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="config-section">
                    <h3 id="settingsTitle">‚öôÔ∏è ÏÑ§Ï†ï</h3>
                    <div class="form-group">
                        <label for="languageSelect" id="labelLanguage">Ïñ∏Ïñ¥ / Language / Langue / Ë®ÄË™û / ËØ≠Ë®Ä</label>
                        <select id="languageSelect">
                            <option value="en">English</option>
                            <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                            <option value="fr">Fran√ßais</option>
                            <option value="ja">Êó•Êú¨Ë™û</option>
                            <option value="zh">‰∏≠Êñá</option>
                        </select>
                        <div class="help-text" id="languageHelp"></div>
                    </div>
                    <div class="form-group">
                        <label for="apiUrl" id="labelApiUrl">API URL:</label>
                        <input type="text" id="apiUrl" value="http://localhost:3000" placeholder="API URLÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                        <div class="help-text" id="apiUrlHelp"></div>
                    </div>
                    <div class="form-group">
                        <label for="apiKey" id="labelApiKey">API ÌÇ§:</label>
                        <input type="text" id="apiKey" value="your-secret-key-here" placeholder="API ÌÇ§Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                        <div class="help-text" id="apiKeyHelp"></div>
                    </div>
                    <div class="form-group">
                        <label for="userId" id="labelUserId">ÏÇ¨Ïö©Ïûê ID:</label>
                        <input type="text" id="userId" value="user_001" placeholder="ÏÇ¨Ïö©Ïûê IDÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                        <div class="help-text" id="userIdHelp"></div>
                    </div>
                    <div class="form-group">
                        <label for="timeout" id="labelTimeout">ÌÉÄÏûÑÏïÑÏõÉ (Ï¥à):</label>
                        <input type="number" id="timeout" value="90" min="30" max="300" placeholder="90">
                        <div class="help-text" id="timeoutHelp"></div>
                    </div>
                    <div class="form-group">
                        <label for="model" id="labelModel">Î™®Îç∏:</label>
                        <select id="model">
                            <option value="">Select a model...</option>
                        </select>
                        <button class="btn btn-secondary" id="refreshModelsBtn" style="margin-top: 5px; width: 100%;">üîÑ Refresh Model List</button>
                        <div class="help-text" id="modelHelp"></div>
                    </div>
                    <button class="btn" id="testConnectionBtn">üîó Test Connection</button>
                    <div class="help-text" id="testConnectionHelp"></div>
                </div>

                <div class="config-section">
                    <h3 id="memoryManageTitle">üß† Memory Management</h3>
                    <button class="btn" id="loadMemoryStatsBtn">üìä Memory Statistics</button>
                    <div class="help-text" id="statsHelp"></div>
                    <button class="btn" id="loadUserMemoryBtn">üìñ View Memory</button>
                    <div class="help-text" id="memoryHelp"></div>
                    <button class="btn btn-secondary" id="addFactBtn">‚ûï Add Fact</button>
                    <div class="help-text" id="addFactHelp"></div>
                    <button class="btn btn-secondary" id="addPreferenceBtn">‚ûï Add Preference</button>
                    <div class="help-text" id="addPrefHelp"></div>
                    <button class="btn btn-danger" id="deleteMemoryBtn">üóëÔ∏è Delete Memory</button>
                    <div class="help-text" id="deleteMemHelp"></div>
                </div>

                <div class="config-section">
                    <h3 id="advancedMemoryTitle">üß† Advanced Memory & Context</h3>
                    <button class="btn" id="loadEmotionalStatsBtn">üòä Emotional Analysis</button>
                    <div class="help-text" id="emotionalHelp"></div>
                    <button class="btn" id="loadTimelineBtn">üìÖ Life Timeline</button>
                    <div class="help-text" id="timelineHelp"></div>
                    <button class="btn" id="loadPatternsBtn">üîç Context Patterns</button>
                    <div class="help-text" id="patternsHelp"></div>
                    <button class="btn btn-secondary" id="addRelationshipBtn">üë• Add Relationship</button>
                    <div class="help-text" id="relationshipHelp"></div>
                    <button class="btn btn-secondary" id="addGoalBtn">üéØ Add Goal</button>
                    <div class="help-text" id="goalHelp"></div>
                    <button class="btn btn-secondary" id="addInterestBtn">‚≠ê Add Interest</button>
                    <div class="help-text" id="interestHelp"></div>
                    <button class="btn btn-secondary" id="addLongTermMemoryBtn">üíæ Add Long-term Memory</button>
                    <div class="help-text" id="longTermHelp"></div>
                </div>

                <div class="memory-stats" id="memoryStats" style="display: none;">
                    <h4>üìä Memory Statistics</h4>
                    <div id="statsContent"></div>
                </div>
            </div>

            <div class="chat-area">
                <div class="chat-messages" id="chatMessages">
                    <div class="message system">
                        <div class="message-header">ÏãúÏä§ÌÖú</div>
                        <div class="message-content" id="welcomeMessage">ÏïàÎÖïÌïòÏÑ∏Ïöî! Î©îÎ™®Î¶¨ Í∏∞Îä•Ïù¥ Ìè¨Ìï®Îêú AI Ï±ÑÌåÖÏóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§. ÏÇ¨Ïö©Ïûê IDÎ•º ÏÑ§Ï†ïÌïòÍ≥† ÎåÄÌôîÎ•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî.</div>
                    </div>
                    <div class="message system">
                        <div class="message-header">ÏãúÏä§ÌÖú</div>
                        <div class="message-content" id="tipMessage">üí° ÌåÅ: Î™®Îç∏ Î™©Î°ùÏù¥ ÏûêÎèôÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§. ÎßåÏïΩ Î°úÎìúÎêòÏßÄ ÏïäÎäîÎã§Î©¥ "üîÑ Î™®Îç∏ Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®" Î≤ÑÌäºÏùÑ ÌÅ¥Î¶≠Ìï¥Î≥¥ÏÑ∏Ïöî.</div>
                    </div>
                </div>

                <div class="loading" id="loading">
                    <div>ü§î AIÍ∞Ä ÏÉùÍ∞Å Ï§ëÏûÖÎãàÎã§...</div>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                </div>

                <div class="chat-input">
                    <div class="input-group">
                        <input type="text" id="messageInput" placeholder="Enter your message..." onkeypress="handleKeyPress(event)">
                        <button id="sendMessageBtn">Send</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        /*
         Multi-language comments for all functions and modules
         - EN: This application provides an AI chat with memory features to support cognitive health. Title aligned with Kairos mission.
         - FR: Cette application offre un chat IA avec m√©moire pour soutenir la sant√© cognitive. Titre align√© avec la mission Kairos.
         - KO: Ïù¥ Ïï†ÌîåÎ¶¨ÏºÄÏù¥ÏÖòÏùÄ Ïù∏ÏßÄ Í∏∞Îä• Í±¥Í∞ïÏùÑ ÎèïÍ∏∞ ÏúÑÌïú Î©îÎ™®Î¶¨ Í∏∞Îä• Ìè¨Ìï® AI Ï±ÑÌåÖÏùÑ Ï†úÍ≥µÌï©ÎãàÎã§. Kairos ÎØ∏ÏÖòÍ≥º ÏùºÏπò.
         - JA: Êú¨„Ç¢„Éó„É™„ÅØË™çÁü•Ê©üËÉΩ„ÅÆÂÅ•Â∫∑„ÇíÊîØÊè¥„Åô„Çã„Åü„ÇÅ„ÅÆ„É°„É¢„É™Ê©üËÉΩ‰ªò„ÅçAI„ÉÅ„É£„ÉÉ„Éà„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇKairos„ÅÆ‰ΩøÂëΩ„Å®Êï¥Âêà„ÄÇ
         - ZH: Êú¨Â∫îÁî®Êèê‰æõÂ∏¶ËÆ∞ÂøÜÂäüËÉΩÁöÑAIËÅäÂ§©Ôºå‰ª•ÊîØÊåÅËÆ§Áü•ÂÅ•Â∫∑„ÄÇ‰∏éKairos‰ΩøÂëΩ‰∏ÄËá¥„ÄÇ
        */

        // Ï†ÑÏó≠ Î≥ÄÏàò / Global variables / Variables globales / „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞ / ÂÖ®Â±ÄÂèòÈáè
        let currentUserId = 'user_001';
        let memoryData = null;

        // DOM ÏöîÏÜåÎì§
        const apiUrlInput = document.getElementById('apiUrl');
        const apiKeyInput = document.getElementById('apiKey');
        const userIdInput = document.getElementById('userId');
        const timeoutInput = document.getElementById('timeout');
        const modelSelect = document.getElementById('model');
        const chatMessages = document.getElementById('chatMessages');
        const messageInput = document.getElementById('messageInput');
        const loading = document.getElementById('loading');
        const memoryStats = document.getElementById('memoryStats');
        const statsContent = document.getElementById('statsContent');

        // ÏÑ§Ï†ïÍ∞í Í∞ÄÏ†∏Ïò§Í∏∞ / Get config / R√©cup√©rer la configuration / Ë®≠ÂÆöÂèñÂæó / Ëé∑ÂèñÈÖçÁΩÆ
        function getConfig() {
            return {
                apiUrl: apiUrlInput.value.trim(),
                apiKey: apiKeyInput.value.trim(),
                userId: userIdInput.value.trim(),
                timeout: parseInt(timeoutInput.value) || 90,
                model: modelSelect.value
            };
        }

        // ÏÉÅÌÉú Î©îÏãúÏßÄ ÌëúÏãú / Show status message / Afficher le statut / „Çπ„ÉÜ„Éº„Çø„Çπ„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫ / ÊòæÁ§∫Áä∂ÊÄÅÊ∂àÊÅØ
        function showStatus(message, type = 'info') {
            const statusDiv = document.createElement('div');
            statusDiv.className = `status ${type}`;
            statusDiv.textContent = message;
            chatMessages.appendChild(statusDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            setTimeout(() => {
                statusDiv.remove();
            }, 5000);
        }

        // Îã§Íµ≠Ïñ¥ Î¶¨ÏÜåÏä§ / i18n resources
        const i18n = {
            en: {
                title: 'üß† Cognitive Function Support AI Chat (Kairos)',
                subtitle: 'AI Chat with Memory for Cognitive Health',
                languageHelp: 'Choose the interface language.',
                apiUrlHelp: 'API server address. Ex: http://localhost:3000 (local), ngrok URL for remote access.',
                apiKeyHelp: 'API key used to authorize requests (Bearer token).',
                userIdHelp: 'Identifier for storing and retrieving your personal memory.',
                timeoutHelp: 'Maximum wait time in seconds before cancellation.',
                modelHelp: 'Choose an installed model. Large models require more VRAM/CPU and are slower.',
                testHelp: 'Check connectivity to /health endpoint.',
                settingsTitle: 'Settings',
                memoryManageTitle: 'Memory Management',
                statsHelp: 'View totals (conversations, facts, preferences).',
                memoryHelp: 'Display saved memory for this user.',
                addFactHelp: 'Add a fact to your personal memory.',
                addPrefHelp: 'Add a preference (ex: preferred language).',
                deleteMemHelp: 'Delete all memory for current user.',
                welcome: 'Welcome! Set your user ID and start chatting.',
                tip: 'Tip: Model list loads automatically. If not, click Refresh.',
                timeoutError: '‚ùå Request timeout. Please try again.',
                timeoutSolutions: 'Solutions: 1) Increase timeout (180-300s), 2) Try lighter model (llama3.1), 3) Check computer specs (GPU/VRAM), 4) Use localhost instead of ngrok, 5) Close other apps',
                computerRequirements: 'üíª Computer Requirements: Good GPU (8GB+ VRAM) recommended for large models. CPU-only mode is slower.',
                refreshModels: 'üîÑ Refresh Model List',
                selectModel: 'Select a model...',
                testConnection: 'üîó Test Connection',
                memoryStats: 'üìä Memory Statistics',
                viewMemory: 'üìñ View Memory',
                addFact: '‚ûï Add Fact',
                addPreference: '‚ûï Add Preference',
                deleteMemory: 'üóëÔ∏è Delete Memory',
                send: 'Send',
                enterMessage: 'Enter your message...',
                totalConversations: 'Total Conversations:',
                totalFacts: 'Total Facts:',
                totalPreferences: 'Total Preferences:',
                createdDate: 'Created:',
                lastUpdated: 'Last Updated:',
                loadingModels: 'üîÑ Loading model list...',
                modelsFound: '‚úÖ Found {count} models',
                noModels: '‚ö†Ô∏è No models installed. Please download models in Ollama.',
                modelLoadTimeout: '‚ùå Model list load timeout. Please try again.',
                serverConnectionError: '‚ùå Cannot connect to server. Please check if server is running.',
                modelLoadError: '‚ùå Model list load failed: {error}',
                defaultModelSelected: '‚úÖ Default model selected: {model}',
                modelSelected: '‚úÖ Model selected: {model}',
                responseDelay: '‚ö†Ô∏è Response is taking longer than expected. Please wait...',
                connectionError: 'Connection error: {error}',
                unknownError: 'Unknown error',
                advancedMemoryTitle: 'üß† Advanced Memory & Context',
                emotionalAnalysis: 'üòä Emotional Analysis',
                lifeTimeline: 'üìÖ Life Timeline',
                contextPatterns: 'üîç Context Patterns',
                addRelationship: 'üë• Add Relationship',
                addGoal: 'üéØ Add Goal',
                addInterest: '‚≠ê Add Interest',
                addLongTermMemory: 'üíæ Add Long-term Memory',
                emotionalHelp: 'Analyze emotional states and trends over time.',
                timelineHelp: 'View life events timeline with emotional impact.',
                patternsHelp: 'Explore conversation patterns and context.',
                relationshipHelp: 'Add important relationships and connections.',
                goalHelp: 'Set and track personal goals and objectives.',
                interestHelp: 'Add interests, hobbies, and preferences.',
                longTermHelp: 'Store important long-term memories and experiences.'
            },
            fr: {
                title: 'üß† Chat IA pour le soutien cognitif (Kairos)',
                subtitle: 'Chat IA avec m√©moire pour la sant√© cognitive',
                languageHelp: 'Choisissez la langue de l‚Äôinterface.',
                apiUrlHelp: 'Adresse du serveur API. Ex.: http://localhost:3000 (local), URL ngrok pour un acc√®s distant.',
                apiKeyHelp: 'Cl√© API utilis√©e pour autoriser les requ√™tes (Bearer token).',
                userIdHelp: "Identifiant pour stocker et r√©cup√©rer votre m√©moire personnelle.",
                timeoutHelp: 'Temps d‚Äôattente maximal en secondes avant l‚Äôannulation.',
                modelHelp: 'Choisissez un mod√®le install√©. Les gros mod√®les exigent plus de VRAM/CPU et sont plus lents.',
                testHelp: 'V√©rifie la connectivit√© au point /health.',
                settingsTitle: 'Param√®tres',
                memoryManageTitle: 'Gestion de la m√©moire',
                statsHelp: 'Voir les totaux (conversations, faits, pr√©f√©rences).',
                memoryHelp: 'Afficher la m√©moire enregistr√©e pour cet utilisateur.',
                addFactHelp: 'Ajouter un fait √† votre m√©moire personnelle.',
                addPrefHelp: 'Ajouter une pr√©f√©rence (ex.: langue pr√©f√©r√©e).',
                deleteMemHelp: 'Supprimer toute la m√©moire de l‚Äôutilisateur courant.',
                welcome: 'Bienvenue ! D√©finissez votre ID utilisateur et commencez √† discuter.',
                tip: 'Astuce : la liste des mod√®les se charge automatiquement. Sinon, cliquez sur Actualiser.',
                timeoutError: '‚ùå D√©lai d\'attente d√©pass√©. Veuillez r√©essayer.',
                timeoutSolutions: 'Solutions : 1) Augmenter le d√©lai (180-300s), 2) Essayer un mod√®le plus l√©ger (llama3.1), 3) V√©rifier les sp√©cifications PC (GPU/VRAM), 4) Utiliser localhost au lieu de ngrok, 5) Fermer d\'autres applications',
                computerRequirements: 'üíª Exigences PC : GPU performant (8GB+ VRAM) recommand√© pour les gros mod√®les. Mode CPU uniquement plus lent.',
                refreshModels: 'üîÑ Actualiser la liste des mod√®les',
                selectModel: 'S√©lectionner un mod√®le...',
                testConnection: 'üîó Tester la connexion',
                memoryStats: 'üìä Statistiques m√©moire',
                viewMemory: 'üìñ Voir la m√©moire',
                addFact: '‚ûï Ajouter un fait',
                addPreference: '‚ûï Ajouter une pr√©f√©rence',
                deleteMemory: 'üóëÔ∏è Supprimer la m√©moire',
                send: 'Envoyer',
                enterMessage: 'Entrez votre message...',
                totalConversations: 'Total conversations :',
                totalFacts: 'Total faits :',
                totalPreferences: 'Total pr√©f√©rences :',
                createdDate: 'Cr√©√© le :',
                lastUpdated: 'Derni√®re mise √† jour :',
                loadingModels: 'üîÑ Chargement de la liste des mod√®les...',
                modelsFound: '‚úÖ {count} mod√®les trouv√©s',
                noModels: '‚ö†Ô∏è Aucun mod√®le install√©. Veuillez t√©l√©charger des mod√®les dans Ollama.',
                modelLoadTimeout: '‚ùå D√©lai de chargement de la liste des mod√®les d√©pass√©. Veuillez r√©essayer.',
                serverConnectionError: '‚ùå Impossible de se connecter au serveur. V√©rifiez que le serveur fonctionne.',
                modelLoadError: '‚ùå √âchec du chargement de la liste des mod√®les : {error}',
                defaultModelSelected: '‚úÖ Mod√®le par d√©faut s√©lectionn√© : {model}',
                modelSelected: '‚úÖ Mod√®le s√©lectionn√© : {model}',
                responseDelay: '‚ö†Ô∏è La r√©ponse prend plus de temps que pr√©vu. Veuillez patienter...',
                connectionError: 'Erreur de connexion : {error}',
                unknownError: 'Erreur inconnue',
                advancedMemoryTitle: 'üß† M√©moire Avanc√©e et Contexte',
                emotionalAnalysis: 'üòä Analyse √âmotionnelle',
                lifeTimeline: 'üìÖ Chronologie de Vie',
                contextPatterns: 'üîç Mod√®les de Contexte',
                addRelationship: 'üë• Ajouter Relation',
                addGoal: 'üéØ Ajouter Objectif',
                addInterest: '‚≠ê Ajouter Int√©r√™t',
                addLongTermMemory: 'üíæ Ajouter M√©moire Longue Dur√©e',
                emotionalHelp: 'Analyser les √©tats √©motionnels et tendances dans le temps.',
                timelineHelp: 'Voir la chronologie des √©v√©nements de vie avec impact √©motionnel.',
                patternsHelp: 'Explorer les mod√®les de conversation et contexte.',
                relationshipHelp: 'Ajouter des relations et connexions importantes.',
                goalHelp: 'D√©finir et suivre les objectifs personnels.',
                interestHelp: 'Ajouter int√©r√™ts, passe-temps et pr√©f√©rences.',
                longTermHelp: 'Stocker des souvenirs et exp√©riences importants √† long terme.'
            },
            ko: {
                title: 'üß† Ïù∏ÏßÄÍ∏∞Îä• Í∞úÏÑ† AI Ï±ÑÌåÖ (Kairos)',
                subtitle: 'Ïù∏ÏßÄ Í±¥Í∞ïÏùÑ ÏúÑÌïú Î©îÎ™®Î¶¨ Í∏∞Îä• Ìè¨Ìï® AI Ï±ÑÌåÖ',
                languageHelp: 'Ïù∏ÌÑ∞ÌéòÏù¥Ïä§ Ïñ∏Ïñ¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.',
                apiUrlHelp: 'API ÏÑúÎ≤Ñ Ï£ºÏÜåÏûÖÎãàÎã§. Ïòà: http://localhost:3000 (Î°úÏª¨), ÏõêÍ≤© Ï†ëÏÜçÏùÄ ngrok URL ÏÇ¨Ïö©.',
                apiKeyHelp: 'ÏÑúÎ≤Ñ ÏöîÏ≤≠ Ïù∏Ï¶ùÏóê ÏÇ¨Ïö©ÌïòÎäî API ÌÇ§ÏûÖÎãàÎã§ (Bearer ÌÜ†ÌÅ∞).',
                userIdHelp: 'Í∞úÏù∏ Î©îÎ™®Î¶¨ Ïª®ÌÖçÏä§Ìä∏ Ï†ÄÏû•/Ï°∞ÌöåÏóê ÏÇ¨Ïö©ÌïòÎäî ÏÇ¨Ïö©Ïûê ÏãùÎ≥ÑÏûêÏûÖÎãàÎã§.',
                timeoutHelp: 'ÏöîÏ≤≠Ïù¥ Ï∑®ÏÜåÎêòÍ∏∞ Ï†ÑÍπåÏßÄ Í∏∞Îã§Î¶¨Îäî ÏµúÎåÄ ÏãúÍ∞Ñ(Ï¥à)ÏûÖÎãàÎã§.',
                modelHelp: 'ÏÑ§ÏπòÎêú Î™®Îç∏ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî. Í≥†Ïö©Îüâ Î™®Îç∏ÏùÄ VRAM/CPU ÏöîÍµ¨ÏôÄ ÏßÄÏó∞Ïù¥ ÌÅΩÎãàÎã§.',
                testHelp: 'API ÏÑúÎ≤Ñ /health Ïó∞Í≤∞ÏùÑ Í≤ÄÏÇ¨Ìï©ÎãàÎã§.',
                settingsTitle: 'ÏÑ§Ï†ï',
                memoryManageTitle: 'Î©îÎ™®Î¶¨ Í¥ÄÎ¶¨',
                statsHelp: 'Ï†ÑÏ≤¥ Í±¥Ïàò(ÎåÄÌôî, ÏÇ¨Ïã§, ÏÑ†Ìò∏)Î•º Î¥ÖÎãàÎã§.',
                memoryHelp: 'ÌòÑÏû¨ ÏÇ¨Ïö©ÏûêÏùò Ï†ÄÏû•Îêú Î©îÎ™®Î¶¨Î•º ÌôïÏù∏Ìï©ÎãàÎã§.',
                addFactHelp: 'Í∞úÏù∏ Î©îÎ™®Î¶¨Ïóê ÏÇ¨Ïã§ Ìï≠Î™©ÏùÑ Ï∂îÍ∞ÄÌï©ÎãàÎã§.',
                addPrefHelp: 'ÏÑ†Ìò∏ Ìï≠Î™©ÏùÑ Ï∂îÍ∞ÄÌï©ÎãàÎã§ (Ïòà: ÏÑ†Ìò∏ Ïñ∏Ïñ¥).',
                deleteMemHelp: 'ÌòÑÏû¨ ÏÇ¨Ïö©ÏûêÏùò Î™®Îì† Î©îÎ™®Î¶¨Î•º ÏÇ≠Ï†úÌï©ÎãàÎã§.',
                welcome: 'ÏïàÎÖïÌïòÏÑ∏Ïöî! ÏÇ¨Ïö©Ïûê IDÎ•º ÏÑ§Ï†ïÌïòÍ≥† ÎåÄÌôîÎ•º ÏãúÏûëÌï¥Î≥¥ÏÑ∏Ïöî.',
                tip: 'ÌåÅ: Î™®Îç∏ Î™©Î°ùÏùÄ ÏûêÎèôÏúºÎ°ú Î°úÎìúÎê©ÎãàÎã§. ÏïàÎêòÎ©¥ ÏÉàÎ°úÍ≥†Ïπ®ÏùÑ ÌÅ¥Î¶≠ÌïòÏÑ∏Ïöî.',
                timeoutError: '‚ùå ÏöîÏ≤≠ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.',
                timeoutSolutions: 'Ìï¥Í≤∞Ï±Ö: 1) ÌÉÄÏûÑÏïÑÏõÉ Ï¶ùÍ∞Ä (180-300Ï¥à), 2) Í∞ÄÎ≤ºÏö¥ Î™®Îç∏ ÏãúÎèÑ (llama3.1), 3) Ïª¥Ìì®ÌÑ∞ ÏÇ¨Ïñë ÌôïÏù∏ (GPU/VRAM), 4) ngrok ÎåÄÏã† localhost ÏÇ¨Ïö©, 5) Îã§Î•∏ Ïï± Ï¢ÖÎ£å',
                computerRequirements: 'üíª Ïª¥Ìì®ÌÑ∞ ÏöîÍµ¨ÏÇ¨Ìï≠: ÎåÄÌòï Î™®Îç∏ÏóêÎäî Ï¢ãÏùÄ GPU (8GB+ VRAM) Í∂åÏû•. CPUÎßå ÏÇ¨Ïö© Ïãú ÎäêÎ¶º.',
                refreshModels: 'üîÑ Î™®Îç∏ Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®',
                selectModel: 'Î™®Îç∏ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî...',
                testConnection: 'üîó Ïó∞Í≤∞ ÌÖåÏä§Ìä∏',
                memoryStats: 'üìä Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ',
                viewMemory: 'üìñ Î©îÎ™®Î¶¨ Ï°∞Ìöå',
                addFact: '‚ûï ÏÇ¨Ïã§ Ï∂îÍ∞Ä',
                addPreference: '‚ûï ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä',
                deleteMemory: 'üóëÔ∏è Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú',
                send: 'Ï†ÑÏÜ°',
                enterMessage: 'Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...',
                totalConversations: 'Ï¥ù ÎåÄÌôî:',
                totalFacts: 'Ï¥ù ÏÇ¨Ïã§:',
                totalPreferences: 'Ï¥ù ÏÑ†Ìò∏ÎèÑ:',
                createdDate: 'ÏÉùÏÑ±Ïùº:',
                lastUpdated: 'ÏµúÏ¢Ö ÏóÖÎç∞Ïù¥Ìä∏:',
                loadingModels: 'üîÑ Î™®Îç∏ Î™©Î°ùÏùÑ Í∞ÄÏ†∏Ïò§Îäî Ï§ë...',
                modelsFound: '‚úÖ {count}Í∞úÏùò Î™®Îç∏ÏùÑ Ï∞æÏïòÏäµÎãàÎã§',
                noModels: '‚ö†Ô∏è ÏÑ§ÏπòÎêú Î™®Îç∏Ïù¥ ÏóÜÏäµÎãàÎã§. OllamaÏóêÏÑú Î™®Îç∏ÏùÑ Îã§Ïö¥Î°úÎìúÌï¥Ï£ºÏÑ∏Ïöî.',
                modelLoadTimeout: '‚ùå Î™®Îç∏ Î™©Î°ù Î°úÎìú ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.',
                serverConnectionError: '‚ùå ÏÑúÎ≤ÑÏóê Ïó∞Í≤∞Ìï† Ïàò ÏóÜÏäµÎãàÎã§. ÏÑúÎ≤ÑÍ∞Ä Ïã§Ìñâ Ï§ëÏù∏ÏßÄ ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.',
                modelLoadError: '‚ùå Î™®Îç∏ Î™©Î°ù Î°úÎìú Ïã§Ìå®: {error}',
                defaultModelSelected: '‚úÖ Í∏∞Î≥∏ Î™®Îç∏ ÏÑ†ÌÉùÎê®: {model}',
                modelSelected: '‚úÖ Î™®Îç∏ ÏÑ†ÌÉùÎê®: {model}',
                responseDelay: '‚ö†Ô∏è ÏùëÎãµÏù¥ Ïò§Îûò Í±∏Î¶¨Í≥† ÏûàÏäµÎãàÎã§. Ïû†ÏãúÎßå Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî...',
                connectionError: 'Ïó∞Í≤∞ Ïò§Î•ò: {error}',
                unknownError: 'Ïïå Ïàò ÏóÜÎäî Ïò§Î•ò',
                advancedMemoryTitle: 'üß† Í≥†Í∏â Î©îÎ™®Î¶¨ Î∞è Îß•ÎùΩ',
                emotionalAnalysis: 'üòä Í∞êÏ†ï Î∂ÑÏÑù',
                lifeTimeline: 'üìÖ Ïù∏ÏÉù ÌÉÄÏûÑÎùºÏù∏',
                contextPatterns: 'üîç Îß•ÎùΩ Ìå®ÌÑ¥',
                addRelationship: 'üë• Í¥ÄÍ≥Ñ Ï∂îÍ∞Ä',
                addGoal: 'üéØ Î™©Ìëú Ï∂îÍ∞Ä',
                addInterest: '‚≠ê Í¥ÄÏã¨ÏÇ¨ Ï∂îÍ∞Ä',
                addLongTermMemory: 'üíæ Ïû•Í∏∞ Í∏∞Ïñµ Ï∂îÍ∞Ä',
                emotionalHelp: 'ÏãúÍ∞ÑÏóê Îî∞Î•∏ Í∞êÏ†ï ÏÉÅÌÉúÏôÄ Ìä∏Î†åÎìúÎ•º Î∂ÑÏÑùÌï©ÎãàÎã§.',
                timelineHelp: 'Í∞êÏ†ïÏ†Å ÏòÅÌñ•ÏùÑ Ìè¨Ìï®Ìïú Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ÏùÑ Î¥ÖÎãàÎã§.',
                patternsHelp: 'ÎåÄÌôî Ìå®ÌÑ¥Í≥º Îß•ÎùΩÏùÑ ÌÉêÏÉâÌï©ÎãàÎã§.',
                relationshipHelp: 'Ï§ëÏöîÌïú Í¥ÄÍ≥ÑÏôÄ Ïó∞Í≤∞ÏùÑ Ï∂îÍ∞ÄÌï©ÎãàÎã§.',
                goalHelp: 'Í∞úÏù∏ Î™©ÌëúÏôÄ Í≥ÑÌöçÏùÑ ÏÑ§Ï†ïÌïòÍ≥† Ï∂îÏ†ÅÌï©ÎãàÎã§.',
                interestHelp: 'Í¥ÄÏã¨ÏÇ¨, Ï∑®ÎØ∏, ÏÑ†Ìò∏ÎèÑÎ•º Ï∂îÍ∞ÄÌï©ÎãàÎã§.',
                longTermHelp: 'Ï§ëÏöîÌïú Ïû•Í∏∞ Í∏∞ÏñµÍ≥º Í≤ΩÌóòÏùÑ Ï†ÄÏû•Ìï©ÎãàÎã§.'
            },
            ja: {
                title: 'üß† Ë™çÁü•Ê©üËÉΩ„Çµ„Éù„Éº„ÉàAI„ÉÅ„É£„ÉÉ„Éà (Kairos)',
                subtitle: 'Ë™çÁü•ÂÅ•Â∫∑„ÅÆ„Åü„ÇÅ„ÅÆ„É°„É¢„É™Ê©üËÉΩ‰ªò„ÅçAI„ÉÅ„É£„ÉÉ„Éà',
                languageHelp: '„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπË®ÄË™û„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                apiUrlHelp: 'API„Çµ„Éº„Éê„Éº„ÅÆÂ†¥ÊâÄ„ÄÇ‰æã: http://localhost:3000„ÄÅ„É™„É¢„Éº„Éà„ÅØngrok URL„ÄÇ',
                apiKeyHelp: '„Çµ„Éº„Éê„ÉºË¶ÅÊ±Ç„ÅÆË™çÂèØ„Å´‰Ωø„ÅÜAPI„Ç≠„ÉºÔºàBearer„Éà„Éº„ÇØ„É≥Ôºâ„ÄÇ',
                userIdHelp: 'ÂÄã‰∫∫„É°„É¢„É™„ÅÆ‰øùÂ≠ò/ÂèñÂæó„Å´‰Ωø„ÅÜ„É¶„Éº„Ç∂„ÉºË≠òÂà•Â≠ê„ÄÇ',
                timeoutHelp: '„Ç≠„É£„É≥„Çª„É´„Åæ„Åß„ÅÆÊúÄÂ§ßÂæÖÊ©üÊôÇÈñìÔºàÁßíÔºâ„ÄÇ',
                modelHelp: '„Ç§„É≥„Çπ„Éà„Éº„É´Ê∏à„Åø„É¢„Éá„É´„ÇíÈÅ∏Êäû„ÄÇÂ§ß„Åç„ÅÑ„É¢„Éá„É´„ÅØVRAM/CPU„ÅåÂ§ö„ÅèÂøÖË¶Å„ÅßÈÅÖ„Åè„Å™„Çä„Åæ„Åô„ÄÇ',
                testHelp: 'API„Çµ„Éº„Éê„Éº /health „Å∏„ÅÆÊé•Á∂ö„ÇíÁ¢∫Ë™ç„ÄÇ',
                settingsTitle: 'Ë®≠ÂÆö',
                memoryManageTitle: '„É°„É¢„É™ÁÆ°ÁêÜ',
                statsHelp: 'ÂêàË®àÔºà‰ºöË©±„ÄÅ‰∫ãÂÆü„ÄÅÂóúÂ•ΩÔºâ„ÇíË°®Á§∫„ÄÇ',
                memoryHelp: '„Åì„ÅÆ„É¶„Éº„Ç∂„Éº„ÅÆ‰øùÂ≠òÊ∏à„Åø„É°„É¢„É™„ÇíË°®Á§∫„ÄÇ',
                addFactHelp: 'ÂÄã‰∫∫„É°„É¢„É™„Å´‰∫ãÂÆü„ÇíËøΩÂä†„ÄÇ',
                addPrefHelp: 'ÂóúÂ•Ω„ÇíËøΩÂä†Ôºà‰æãÔºöÂ•Ω„Åç„Å™Ë®ÄË™ûÔºâ„ÄÇ',
                deleteMemHelp: 'ÁèæÂú®„É¶„Éº„Ç∂„Éº„ÅÆÂÖ®„É°„É¢„É™„ÇíÂâäÈô§„ÄÇ',
                welcome: '„Çà„ÅÜ„Åì„ÅùÔºÅ„É¶„Éº„Ç∂„ÉºID„ÇíË®≠ÂÆö„Åó„Å¶‰ºöË©±„ÇíÂßã„ÇÅ„Åæ„Åó„Çá„ÅÜ„ÄÇ',
                tip: '„Éí„É≥„ÉàÔºö„É¢„Éá„É´‰∏ÄË¶ß„ÅØËá™ÂãïË™≠Ëæº„ÄÇ„Å†„ÇÅ„Å™„ÇâÊõ¥Êñ∞„Çí„ÇØ„É™„ÉÉ„ÇØ„ÄÇ',
                timeoutError: '‚ùå „É™„ÇØ„Ç®„Çπ„Éà„Åå„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„Åü„ÄÇÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                timeoutSolutions: 'Ëß£Ê±∫Á≠ñÔºö1) „Çø„Ç§„É†„Ç¢„Ç¶„ÉàÂª∂Èï∑ (180-300Áßí), 2) ËªΩÈáè„É¢„Éá„É´Ë©¶Ë°å (llama3.1), 3) PC‰ªïÊßòÁ¢∫Ë™ç (GPU/VRAM), 4) ngrok„ÅÆ‰ª£„Çè„Çä„Å´localhost‰ΩøÁî®, 5) ‰ªñ„ÅÆ„Ç¢„Éó„É™ÁµÇ‰∫Ü',
                computerRequirements: 'üíª PCË¶Å‰ª∂ÔºöÂ§ßÂÆπÈáè„É¢„Éá„É´„Å´„ÅØÈ´òÊÄßËÉΩGPU (8GB+ VRAM) Êé®Â•®„ÄÇCPU„ÅÆ„Åø„ÅÆ„É¢„Éº„Éâ„ÅØÈÅÖ„ÅÑ„ÄÇ',
                refreshModels: 'üîÑ „É¢„Éá„É´‰∏ÄË¶ßÊõ¥Êñ∞',
                selectModel: '„É¢„Éá„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ...',
                testConnection: 'üîó Êé•Á∂ö„ÉÜ„Çπ„Éà',
                memoryStats: 'üìä „É°„É¢„É™Áµ±Ë®à',
                viewMemory: 'üìñ „É°„É¢„É™Ë°®Á§∫',
                addFact: '‚ûï ‰∫ãÂÆüËøΩÂä†',
                addPreference: '‚ûï ÂóúÂ•ΩËøΩÂä†',
                deleteMemory: 'üóëÔ∏è „É°„É¢„É™ÂâäÈô§',
                send: 'ÈÄÅ‰ø°',
                enterMessage: '„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ...',
                totalConversations: 'Á∑è‰ºöË©±Êï∞Ôºö',
                totalFacts: 'Á∑è‰∫ãÂÆüÊï∞Ôºö',
                totalPreferences: 'Á∑èÂóúÂ•ΩÊï∞Ôºö',
                createdDate: '‰ΩúÊàêÊó•Ôºö',
                lastUpdated: 'ÊúÄÁµÇÊõ¥Êñ∞Ôºö',
                loadingModels: 'üîÑ „É¢„Éá„É´‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„Åø‰∏≠...',
                modelsFound: '‚úÖ {count}ÂÄã„ÅÆ„É¢„Éá„É´„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åó„Åü',
                noModels: '‚ö†Ô∏è „Ç§„É≥„Çπ„Éà„Éº„É´„Åï„Çå„Åü„É¢„Éá„É´„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇOllama„Åß„É¢„Éá„É´„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                modelLoadTimeout: '‚ùå „É¢„Éá„É´‰∏ÄË¶ß„ÅÆË™≠„ÅøËæº„Åø„Åå„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„Åü„ÄÇÂÜçË©¶Ë°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                serverConnectionError: '‚ùå „Çµ„Éº„Éê„Éº„Å´Êé•Á∂ö„Åß„Åç„Åæ„Åõ„Çì„ÄÇ„Çµ„Éº„Éê„Éº„ÅåÂÆüË°å‰∏≠„ÅãÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                modelLoadError: '‚ùå „É¢„Éá„É´‰∏ÄË¶ß„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„ÅüÔºö{error}',
                defaultModelSelected: '‚úÖ „Éá„Éï„Ç©„É´„Éà„É¢„Éá„É´„ÅåÈÅ∏Êäû„Åï„Çå„Åæ„Åó„ÅüÔºö{model}',
                modelSelected: '‚úÖ „É¢„Éá„É´„ÅåÈÅ∏Êäû„Åï„Çå„Åæ„Åó„ÅüÔºö{model}',
                responseDelay: '‚ö†Ô∏è ÂøúÁ≠î„Å´ÊôÇÈñì„Åå„Åã„Åã„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åó„Å∞„Çâ„Åè„ÅäÂæÖ„Å°„Åè„Å†„Åï„ÅÑ...',
                connectionError: 'Êé•Á∂ö„Ç®„É©„ÉºÔºö{error}',
                unknownError: '‰∏çÊòé„Å™„Ç®„É©„Éº',
                advancedMemoryTitle: 'üß† È´òÂ∫¶„Å™„É°„É¢„É™„Å®„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà',
                emotionalAnalysis: 'üòä ÊÑüÊÉÖÂàÜÊûê',
                lifeTimeline: 'üìÖ ‰∫∫Áîü„Çø„Ç§„É†„É©„Ç§„É≥',
                contextPatterns: 'üîç „Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Éë„Çø„Éº„É≥',
                addRelationship: 'üë• Èñ¢‰øÇÊÄßËøΩÂä†',
                addGoal: 'üéØ ÁõÆÊ®ôËøΩÂä†',
                addInterest: '‚≠ê ËààÂë≥ËøΩÂä†',
                addLongTermMemory: 'üíæ Èï∑ÊúüË®òÊÜ∂ËøΩÂä†',
                emotionalHelp: 'ÊôÇÈñìÁµåÈÅé„Å´„Çà„ÇãÊÑüÊÉÖÁä∂ÊÖã„Å®„Éà„É¨„É≥„Éâ„ÇíÂàÜÊûê„Åó„Åæ„Åô„ÄÇ',
                timelineHelp: 'ÊÑüÊÉÖÁöÑÂΩ±Èüø„ÇíÂê´„ÇÄ‰∫∫Áîü„Ç§„Éô„É≥„Éà„ÅÆ„Çø„Ç§„É†„É©„Ç§„É≥„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ',
                patternsHelp: '‰ºöË©±„Éë„Çø„Éº„É≥„Å®„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„ÇíÊé¢Á¥¢„Åó„Åæ„Åô„ÄÇ',
                relationshipHelp: 'ÈáçË¶Å„Å™Èñ¢‰øÇÊÄß„Å®„Å§„Å™„Åå„Çä„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ',
                goalHelp: 'ÂÄã‰∫∫„ÅÆÁõÆÊ®ô„Å®Ë®àÁîª„ÇíË®≠ÂÆö„ÉªËøΩË∑°„Åó„Åæ„Åô„ÄÇ',
                interestHelp: 'ËààÂë≥„ÄÅË∂£Âë≥„ÄÅÂ•Ω„Åø„ÇíËøΩÂä†„Åó„Åæ„Åô„ÄÇ',
                longTermHelp: 'ÈáçË¶Å„Å™Èï∑ÊúüË®òÊÜ∂„Å®ÁµåÈ®ì„Çí‰øùÂ≠ò„Åó„Åæ„Åô„ÄÇ'
            },
            zh: {
                title: 'üß† ËÆ§Áü•ÂäüËÉΩÊèêÂçáAIËÅäÂ§© (Kairos)',
                subtitle: 'Áî®‰∫éËÆ§Áü•ÂÅ•Â∫∑ÁöÑÂ∏¶ËÆ∞ÂøÜAIËÅäÂ§©',
                languageHelp: 'ÈÄâÊã©ÁïåÈù¢ËØ≠Ë®Ä„ÄÇ',
                apiUrlHelp: 'APIÊúçÂä°Âô®Âú∞ÂùÄ„ÄÇ‰æãÂ¶Ç: http://localhost:3000ÔºåÊú¨Êú∫ÔºõËøúÁ®ãÂèØÁî®ngrok URL„ÄÇ',
                apiKeyHelp: 'Áî®‰∫éÂêëÊúçÂä°Âô®ÊéàÊùÉÁöÑAPIÂØÜÈí•ÔºàBearer‰ª§ÁâåÔºâ„ÄÇ',
                userIdHelp: 'Áî®‰∫éÂ≠òÂÇ®/ËØªÂèñ‰∏™‰∫∫ËÆ∞ÂøÜ‰∏ä‰∏ãÊñáÁöÑÁî®Êà∑Ê†áËØÜ„ÄÇ',
                timeoutHelp: 'ËØ∑Ê±ÇË¢´ÂèñÊ∂àÂâçÁöÑÊúÄÈïøÁ≠âÂæÖÊó∂Èó¥ÔºàÁßíÔºâ„ÄÇ',
                modelHelp: 'ÈÄâÊã©Â∑≤ÂÆâË£ÖÁöÑÊ®°Âûã„ÄÇ‰ΩìÁßØÊõ¥Â§ßÁöÑÊ®°ÂûãÈúÄË¶ÅÊõ¥Â§öVRAM/CPUÔºåÂìçÂ∫îÊõ¥ÊÖ¢„ÄÇ',
                testHelp: 'Ê£ÄÊü•Âà∞APIÊúçÂä°Âô® /health ÁöÑËøûÈÄöÊÄß„ÄÇ',
                settingsTitle: 'ËÆæÁΩÆ',
                memoryManageTitle: 'ËÆ∞ÂøÜÁÆ°ÁêÜ',
                statsHelp: 'Êü•ÁúãÊÄªÊï∞Ôºà‰ºöËØù„ÄÅ‰∫ãÂÆû„ÄÅÂÅèÂ•ΩÔºâ„ÄÇ',
                memoryHelp: 'Êü•ÁúãËØ•Áî®Êà∑‰øùÂ≠òÁöÑËÆ∞ÂøÜÂÜÖÂÆπ„ÄÇ',
                addFactHelp: 'Âêë‰∏™‰∫∫ËÆ∞ÂøÜÊ∑ªÂä†‰∏Ä‰∏™‰∫ãÂÆû„ÄÇ',
                addPrefHelp: 'Ê∑ªÂä†‰∏Ä‰∏™ÂÅèÂ•ΩÔºà‰æãÂ¶ÇÔºöÂÅèÂ•ΩËØ≠Ë®ÄÔºâ„ÄÇ',
                deleteMemHelp: 'Âà†Èô§ÂΩìÂâçÁî®Êà∑ÁöÑÂÖ®ÈÉ®ËÆ∞ÂøÜ„ÄÇ',
                welcome: 'Ê¨¢ËøéÔºÅËØ∑ËÆæÁΩÆÁî®Êà∑IDÂπ∂ÂºÄÂßãËÅäÂ§©„ÄÇ',
                tip: 'ÊèêÁ§∫ÔºöÊ®°ÂûãÂàóË°®‰ºöËá™Âä®Âä†ËΩΩ„ÄÇÂ¶ÇÊú™ÊòæÁ§∫ÔºåËØ∑ÁÇπÂáªÂà∑Êñ∞„ÄÇ',
                timeoutError: '‚ùå ËØ∑Ê±ÇË∂ÖÊó∂„ÄÇËØ∑ÈáçËØï„ÄÇ',
                timeoutSolutions: 'Ëß£ÂÜ≥ÊñπÊ°àÔºö1) Â¢ûÂä†Ë∂ÖÊó∂Êó∂Èó¥ (180-300Áßí), 2) Â∞ùËØïËΩªÈáèÊ®°Âûã (llama3.1), 3) Ê£ÄÊü•ÁîµËÑëÈÖçÁΩÆ (GPU/VRAM), 4) ‰ΩøÁî®localhostËÄåÈùûngrok, 5) ÂÖ≥Èó≠ÂÖ∂‰ªñÂ∫îÁî®',
                computerRequirements: 'üíª ÁîµËÑëË¶ÅÊ±ÇÔºöÂ§ßÊ®°ÂûãÊé®Ëçê‰ΩøÁî®È´òÊÄßËÉΩGPU (8GB+ VRAM)„ÄÇ‰ªÖCPUÊ®°ÂºèËæÉÊÖ¢„ÄÇ',
                refreshModels: 'üîÑ Âà∑Êñ∞Ê®°ÂûãÂàóË°®',
                selectModel: 'ÈÄâÊã©Ê®°Âûã...',
                testConnection: 'üîó ÊµãËØïËøûÊé•',
                memoryStats: 'üìä ÂÜÖÂ≠òÁªüËÆ°',
                viewMemory: 'üìñ Êü•ÁúãÂÜÖÂ≠ò',
                addFact: '‚ûï Ê∑ªÂä†‰∫ãÂÆû',
                addPreference: '‚ûï Ê∑ªÂä†ÂÅèÂ•Ω',
                deleteMemory: 'üóëÔ∏è Âà†Èô§ÂÜÖÂ≠ò',
                send: 'ÂèëÈÄÅ',
                enterMessage: 'ËæìÂÖ•ÊÇ®ÁöÑÊ∂àÊÅØ...',
                totalConversations: 'ÊÄª‰ºöËØùÊï∞Ôºö',
                totalFacts: 'ÊÄª‰∫ãÂÆûÊï∞Ôºö',
                totalPreferences: 'ÊÄªÂÅèÂ•ΩÊï∞Ôºö',
                createdDate: 'ÂàõÂª∫Êó•ÊúüÔºö',
                lastUpdated: 'ÊúÄÂêéÊõ¥Êñ∞Ôºö',
                loadingModels: 'üîÑ Ê≠£Âú®Âä†ËΩΩÊ®°ÂûãÂàóË°®...',
                modelsFound: '‚úÖ ÊâæÂà∞ {count} ‰∏™Ê®°Âûã',
                noModels: '‚ö†Ô∏è Êú™ÂÆâË£ÖÊ®°Âûã„ÄÇËØ∑Âú®Ollama‰∏≠‰∏ãËΩΩÊ®°Âûã„ÄÇ',
                modelLoadTimeout: '‚ùå Ê®°ÂûãÂàóË°®Âä†ËΩΩË∂ÖÊó∂„ÄÇËØ∑ÈáçËØï„ÄÇ',
                serverConnectionError: '‚ùå Êó†Ê≥ïËøûÊé•Âà∞ÊúçÂä°Âô®„ÄÇËØ∑Ê£ÄÊü•ÊúçÂä°Âô®ÊòØÂê¶ËøêË°å„ÄÇ',
                modelLoadError: '‚ùå Ê®°ÂûãÂàóË°®Âä†ËΩΩÂ§±Ë¥•Ôºö{error}',
                defaultModelSelected: '‚úÖ Â∑≤ÈÄâÊã©ÈªòËÆ§Ê®°ÂûãÔºö{model}',
                modelSelected: '‚úÖ Â∑≤ÈÄâÊã©Ê®°ÂûãÔºö{model}',
                responseDelay: '‚ö†Ô∏è ÂìçÂ∫îÊó∂Èó¥ËæÉÈïøÔºåËØ∑Á®çÂÄô...',
                connectionError: 'ËøûÊé•ÈîôËØØÔºö{error}',
                unknownError: 'Êú™Áü•ÈîôËØØ',
                advancedMemoryTitle: 'üß† È´òÁ∫ßËÆ∞ÂøÜ‰∏é‰∏ä‰∏ãÊñá',
                emotionalAnalysis: 'üòä ÊÉÖÊÑüÂàÜÊûê',
                lifeTimeline: 'üìÖ ‰∫∫ÁîüÊó∂Èó¥Á∫ø',
                contextPatterns: 'üîç ‰∏ä‰∏ãÊñáÊ®°Âºè',
                addRelationship: 'üë• Ê∑ªÂä†ÂÖ≥Á≥ª',
                addGoal: 'üéØ Ê∑ªÂä†ÁõÆÊ†á',
                addInterest: '‚≠ê Ê∑ªÂä†ÂÖ¥Ë∂£',
                addLongTermMemory: 'üíæ Ê∑ªÂä†ÈïøÊúüËÆ∞ÂøÜ',
                emotionalHelp: 'ÂàÜÊûêÈöèÊó∂Èó¥ÂèòÂåñÁöÑÊÉÖÊÑüÁä∂ÊÄÅÂíåË∂ãÂäø„ÄÇ',
                timelineHelp: 'Êü•ÁúãÂåÖÂê´ÊÉÖÊÑüÂΩ±ÂìçÁöÑ‰∫∫Áîü‰∫ã‰ª∂Êó∂Èó¥Á∫ø„ÄÇ',
                patternsHelp: 'Êé¢Á¥¢ÂØπËØùÊ®°ÂºèÂíå‰∏ä‰∏ãÊñá„ÄÇ',
                relationshipHelp: 'Ê∑ªÂä†ÈáçË¶ÅÁöÑÂÖ≥Á≥ªÂíåËøûÊé•„ÄÇ',
                goalHelp: 'ËÆæÁΩÆÂíåË∑üË∏™‰∏™‰∫∫ÁõÆÊ†áÂíåËÆ°Âàí„ÄÇ',
                interestHelp: 'Ê∑ªÂä†ÂÖ¥Ë∂£„ÄÅÁà±Â•ΩÂíåÂÅèÂ•Ω„ÄÇ',
                longTermHelp: 'Â≠òÂÇ®ÈáçË¶ÅÁöÑÈïøÊúüËÆ∞ÂøÜÂíåÁªèÈ™å„ÄÇ'
            }
        };

        function applyTranslations(lang) {
            const t = i18n[lang] || i18n.en;
            document.getElementById('mainTitle').textContent = t.title;
            document.getElementById('subtitle').textContent = t.subtitle;
            document.getElementById('settingsTitle').textContent = t.settingsTitle;
            document.getElementById('memoryManageTitle').textContent = t.memoryManageTitle;
            document.getElementById('languageHelp').textContent = t.languageHelp;
            document.getElementById('apiUrlHelp').textContent = t.apiUrlHelp;
            document.getElementById('apiKeyHelp').textContent = t.apiKeyHelp;
            document.getElementById('userIdHelp').textContent = t.userIdHelp;
            document.getElementById('timeoutHelp').textContent = t.timeoutHelp;
            document.getElementById('modelHelp').textContent = t.modelHelp;
            document.getElementById('testConnectionHelp').textContent = t.testHelp;
            document.getElementById('statsHelp').textContent = t.statsHelp;
            document.getElementById('memoryHelp').textContent = t.memoryHelp;
            document.getElementById('addFactHelp').textContent = t.addFactHelp;
            document.getElementById('addPrefHelp').textContent = t.addPrefHelp;
            document.getElementById('deleteMemHelp').textContent = t.deleteMemHelp;
            document.getElementById('welcomeMessage').textContent = t.welcome;
            document.getElementById('tipMessage').textContent = `üí° ${t.tip}`;
            
            // Update button texts
            document.getElementById('refreshModelsBtn').textContent = t.refreshModels;
            document.getElementById('testConnectionBtn').textContent = t.testConnection;
            document.getElementById('loadMemoryStatsBtn').textContent = t.memoryStats;
            document.getElementById('loadUserMemoryBtn').textContent = t.viewMemory;
            document.getElementById('addFactBtn').textContent = t.addFact;
            document.getElementById('addPreferenceBtn').textContent = t.addPreference;
            document.getElementById('deleteMemoryBtn').textContent = t.deleteMemory;
            document.getElementById('sendMessageBtn').textContent = t.send;
            
            // Update placeholders
            document.getElementById('model').options[0].textContent = t.selectModel;
            document.getElementById('messageInput').placeholder = t.enterMessage;
            
            // Update memory stats labels
            const statsLabels = document.querySelectorAll('.stats-label');
            if (statsLabels.length > 0) {
                statsLabels[0].textContent = t.totalConversations;
                statsLabels[1].textContent = t.totalFacts;
                statsLabels[2].textContent = t.totalPreferences;
                statsLabels[3].textContent = t.createdDate;
                statsLabels[4].textContent = t.lastUpdated;
            }
            
            // Update advanced memory section
            const advancedMemoryTitle = document.getElementById('advancedMemoryTitle');
            if (advancedMemoryTitle) advancedMemoryTitle.textContent = t.advancedMemoryTitle;
            
            // Update advanced memory buttons
            const advancedButtons = {
                'loadEmotionalStatsBtn': t.emotionalAnalysis,
                'loadTimelineBtn': t.lifeTimeline,
                'loadPatternsBtn': t.contextPatterns,
                'addRelationshipBtn': t.addRelationship,
                'addGoalBtn': t.addGoal,
                'addInterestBtn': t.addInterest,
                'addLongTermMemoryBtn': t.addLongTermMemory
            };
            
            for (const [id, text] of Object.entries(advancedButtons)) {
                const element = document.getElementById(id);
                if (element) element.textContent = text;
            }
            
            // Update help texts
            const helpTexts = {
                'emotionalHelp': t.emotionalHelp,
                'timelineHelp': t.timelineHelp,
                'patternsHelp': t.patternsHelp,
                'relationshipHelp': t.relationshipHelp,
                'goalHelp': t.goalHelp,
                'interestHelp': t.interestHelp,
                'longTermHelp': t.longTermHelp
            };
            
            for (const [id, text] of Object.entries(helpTexts)) {
                const element = document.getElementById(id);
                if (element) element.textContent = text;
            }
        }

        // Î™®Îç∏ Î™©Î°ù Î°úÎìú / Load model list / Charger la liste des mod√®les / „É¢„Éá„É´‰∏ÄË¶ß„ÇíË™≠„ÅøËæº„ÇÄ / Âä†ËΩΩÊ®°ÂûãÂàóË°®
        async function loadModels() {
            const config = getConfig();
            
            // API URL Í≤ÄÏ¶ù
            if (!config.apiUrl || config.apiUrl === '') {
                const currentLang = document.getElementById('languageSelect').value;
                const t = i18n[currentLang] || i18n.en;
                showStatus('‚ùå ' + t.apiUrlHelp.split('.')[0], 'error');
                return;
            }
            
                        try {
                const currentLang = document.getElementById('languageSelect').value;
                const t = i18n[currentLang] || i18n.en;
                showStatus(t.loadingModels, 'info');
                
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/models`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    const data = await response.json();
                    if (data.models && data.models.length > 0) {
                        populateModelSelect(data.models);
                        const currentLang = document.getElementById('languageSelect').value;
                        const t = i18n[currentLang] || i18n.en;
                        showStatus(t.modelsFound.replace('{count}', data.models.length), 'success');
                    } else {
                        const currentLang = document.getElementById('languageSelect').value;
                        const t = i18n[currentLang] || i18n.en;
                        showStatus(t.noModels, 'info');
                    }
                } else {
                    const errorText = await response.text();
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus(`‚ùå HTTP ${response.status}`, 'error');
                    console.error('Response error:', errorText);
                }
            } catch (error) {
                const currentLang = document.getElementById('languageSelect').value;
                const t = i18n[currentLang] || i18n.en;
                if (error.name === 'AbortError') {
                    showStatus(t.modelLoadTimeout, 'error');
                } else if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                    showStatus(t.serverConnectionError, 'error');
                } else {
                    showStatus(t.modelLoadError.replace('{error}', error.message), 'error');
                }
                console.error('Fetch error:', error);
            }
        }

        // Î™®Îç∏ ÏÑ†ÌÉù ÏòµÏÖò Ï±ÑÏö∞Í∏∞ / Populate model select / Remplir la liste des mod√®les / „É¢„Éá„É´ÈÅ∏Êäû„Å´ÂèçÊò† / Â°´ÂÖÖÊ®°Âûã‰∏ãÊãâ
        function populateModelSelect(models) {
            const modelSelect = document.getElementById('model');
            
            // Í∏∞Ï°¥ ÏòµÏÖòÎì§ Ï†úÍ±∞ (Ï≤´ Î≤àÏß∏ "Î™®Îç∏ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî" ÏòµÏÖò Ï†úÏô∏)
            while (modelSelect.children.length > 1) {
                modelSelect.removeChild(modelSelect.lastChild);
            }
            
            // ÏÉà Î™®Îç∏Îì§ Ï∂îÍ∞Ä
            models.forEach(model => {
                const option = document.createElement('option');
                option.value = model.name;
                option.textContent = `${model.name} (${formatFileSize(model.size)})`;
                modelSelect.appendChild(option);
            });
            
            // Í∏∞Î≥∏ Î™®Îç∏ ÏûêÎèô ÏÑ†ÌÉù
            if (models.length > 0) {
                // jinbora/deepseek-r1-Bllossom:8b Î™®Îç∏Ïù¥ ÏûàÏúºÎ©¥ Ïö∞ÏÑ† ÏÑ†ÌÉù
                const preferredModel = models.find(model => 
                    model.name.includes('jinbora/deepseek-r1-Bllossom:8b') ||
                    model.name.includes('deepseek') ||
                    model.name.includes('llama') ||
                    model.name.includes('mistral')
                );
                
                if (preferredModel) {
                    modelSelect.value = preferredModel.name;
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus(t.defaultModelSelected.replace('{model}', preferredModel.name), 'success');
                } else {
                    // Ï≤´ Î≤àÏß∏ Î™®Îç∏ ÏÑ†ÌÉù
                    modelSelect.value = models[0].name;
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus(t.modelSelected.replace('{model}', models[0].name), 'success');
                }
            }
        }

        // ÌååÏùº ÌÅ¨Í∏∞ Ìè¨Îß∑ÌåÖ / Format file size / Formater la taille / „Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫Êï¥ÂΩ¢ / Ê†ºÂºèÂåñÊñá‰ª∂Â§ßÂ∞è
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Ïó∞Í≤∞ ÌÖåÏä§Ìä∏ / Connection test / Test de connexion / Êé•Á∂ö„ÉÜ„Çπ„Éà / ËøûÊé•ÊµãËØï
        async function testConnection() {
            const config = getConfig();
            
            try {
                showStatus('üîó ÏÑúÎ≤ÑÏóê Ïó∞Í≤∞ Ï§ë...', 'info');
                
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/health`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    const data = await response.json();
                    showStatus(`‚úÖ Ïó∞Í≤∞ ÏÑ±Í≥µ! ÏÑúÎ≤Ñ ÏÉÅÌÉú: ${data.status}`, 'success');
                } else {
                    showStatus('‚ùå Ïó∞Í≤∞ Ïã§Ìå®: ÏÑúÎ≤Ñ ÏùëÎãµ Ïò§Î•ò', 'error');
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    showStatus('‚ùå Ïó∞Í≤∞ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                } else {
                    showStatus(`‚ùå Ïó∞Í≤∞ Ïã§Ìå®: ${error.message}`, 'error');
                }
            }
        }

        // Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ Î°úÎìú / Load memory stats / Charger les statistiques / „É°„É¢„É™Áµ±Ë®àË™≠„ÅøËæº„Åø / Âä†ËΩΩËÆ∞ÂøÜÁªüËÆ°
        async function loadMemoryStats() {
            const config = getConfig();
            
            try {
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/stats`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    const stats = await response.json();
                    displayMemoryStats(stats);
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus('‚úÖ Memory stats loaded', 'success');
                } else {
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus('‚ùå Memory stats load failed', 'error');
                }
            } catch (error) {
                const currentLang = document.getElementById('languageSelect').value;
                const t = i18n[currentLang] || i18n.en;
                if (error.name === 'AbortError') {
                    showStatus('‚ùå Memory stats load timeout', 'error');
                } else {
                    showStatus(`‚ùå Memory stats load failed: ${error.message}`, 'error');
                }
            }
        }

        // Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ ÌëúÏãú / Display memory stats / Afficher statistiques / Áµ±Ë®àË°®Á§∫ / ÊòæÁ§∫ÁªüËÆ°
        function displayMemoryStats(stats) {
            const currentLang = document.getElementById('languageSelect').value;
            const t = i18n[currentLang] || i18n.en;
            statsContent.innerHTML = `
                <div class="stat-item">
                    <span class="stats-label">${t.totalConversations}</span>
                    <span class="stat-value">${stats.totalConversations}</span>
                </div>
                <div class="stat-item">
                    <span class="stats-label">${t.totalFacts}</span>
                    <span class="stat-value">${stats.totalFacts}</span>
                </div>
                <div class="stat-item">
                    <span class="stats-label">${t.totalPreferences}</span>
                    <span class="stat-value">${stats.totalPreferences}</span>
                </div>
                <div class="stat-item">
                    <span class="stats-label">${t.createdDate}</span>
                    <span class="stat-value">${new Date(stats.createdAt).toLocaleDateString()}</span>
                </div>
                <div class="stat-item">
                    <span class="stats-label">${t.lastUpdated}</span>
                    <span class="stat-value">${new Date(stats.lastUpdated).toLocaleDateString()}</span>
                </div>
            `;
            memoryStats.style.display = 'block';
        }

        // ÏÇ¨Ïö©Ïûê Î©îÎ™®Î¶¨ Î°úÎìú / Load user memory / Charger la m√©moire utilisateur / „É¶„Éº„Ç∂„Éº„É°„É¢„É™Ë™≠„ÅøËæº„Åø / Âä†ËΩΩÁî®Êà∑ËÆ∞ÂøÜ
        async function loadUserMemory() {
            const config = getConfig();
            
            try {
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    memoryData = await response.json();
                    displayMemoryData(memoryData);
                    showStatus('‚úÖ ÏÇ¨Ïö©Ïûê Î©îÎ™®Î¶¨ Î°úÎìú ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå ÏÇ¨Ïö©Ïûê Î©îÎ™®Î¶¨ Î°úÎìú Ïã§Ìå®', 'error');
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    showStatus('‚ùå ÏÇ¨Ïö©Ïûê Î©îÎ™®Î¶¨ Î°úÎìú ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                } else {
                    showStatus(`‚ùå ÏÇ¨Ïö©Ïûê Î©îÎ™®Î¶¨ Î°úÎìú Ïã§Ìå®: ${error.message}`, 'error');
                }
            }
        }

        // Î©îÎ™®Î¶¨ Îç∞Ïù¥ÌÑ∞ ÌëúÏãú / Display memory data / Afficher la m√©moire / „É°„É¢„É™ÂÜÖÂÆπË°®Á§∫ / ÊòæÁ§∫ËÆ∞ÂøÜÂÜÖÂÆπ
        function displayMemoryData(memory) {
            // ÏÇ¨Ïù¥ÎìúÎ∞îÏóê Î©îÎ™®Î¶¨ ÎÇ¥Ïö© ÌëúÏãú
            const sidebar = document.querySelector('.sidebar');
            
            // Í∏∞Ï°¥ Î©îÎ™®Î¶¨ ÌëúÏãú ÏòÅÏó≠ Ï†úÍ±∞
            const existingMemoryDisplay = document.getElementById('memoryDisplay');
            if (existingMemoryDisplay) {
                existingMemoryDisplay.remove();
            }

            const memoryDisplay = document.createElement('div');
            memoryDisplay.id = 'memoryDisplay';
            memoryDisplay.className = 'config-section';
            memoryDisplay.innerHTML = '<h3>üìñ Î©îÎ™®Î¶¨ ÎÇ¥Ïö©</h3>';

            // ÏÇ¨Ïã§Îì§ ÌëúÏãú
            if (memory.facts.length > 0) {
                memoryDisplay.innerHTML += '<h4>ÏÇ¨Ïã§Îì§:</h4>';
                memory.facts.forEach(fact => {
                    memoryDisplay.innerHTML += `
                        <div class="memory-item">
                            <div class="timestamp">${new Date(fact.timestamp).toLocaleString()}</div>
                            <div class="content">${fact.content}</div>
                        </div>
                    `;
                });
            }

            // ÏÑ†Ìò∏ÎèÑÎì§ ÌëúÏãú
            if (memory.preferences.length > 0) {
                memoryDisplay.innerHTML += '<h4>ÏÑ†Ìò∏ÎèÑ:</h4>';
                memory.preferences.forEach(pref => {
                    memoryDisplay.innerHTML += `
                        <div class="memory-item">
                            <div class="timestamp">${new Date(pref.timestamp).toLocaleString()}</div>
                            <div class="content">${pref.preference}: ${pref.value}</div>
                        </div>
                    `;
                });
            }

            sidebar.appendChild(memoryDisplay);
        }

        // ÏÇ¨Ïã§ Ï∂îÍ∞Ä / Add fact / Ajouter un fait / ‰∫ãÂÆü„ÇíËøΩÂä† / Ê∑ªÂä†‰∫ãÂÆû
        async function addFact() {
            const fact = prompt('Ï∂îÍ∞ÄÌï† ÏÇ¨Ïã§ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (!fact) return;

            const category = prompt('Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Í∏∞Î≥∏Í∞í: general):') || 'general';
            const config = getConfig();

            try {
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/facts`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({ fact, category }),
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    showStatus('‚úÖ ÏÇ¨Ïã§ Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                    loadMemoryStats();
                } else {
                    showStatus('‚ùå ÏÇ¨Ïã§ Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    showStatus('‚ùå ÏÇ¨Ïã§ Ï∂îÍ∞Ä ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                } else {
                    showStatus(`‚ùå ÏÇ¨Ïã§ Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
                }
            }
        }

        // ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä / Add preference / Ajouter une pr√©f√©rence / ÂóúÂ•Ω„ÇíËøΩÂä† / Ê∑ªÂä†ÂÅèÂ•Ω
        async function addPreference() {
            const preference = prompt('ÏÑ†Ìò∏ÎèÑ Ìï≠Î™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç Ïñ∏Ïñ¥):');
            if (!preference) return;

            const value = prompt('ÏÑ†Ìò∏ÎèÑ Í∞íÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: Python, JavaScript):');
            if (!value) return;

            const config = getConfig();

            try {
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/preferences`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({ preference, value }),
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    showStatus('‚úÖ ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                    loadMemoryStats();
                } else {
                    showStatus('‚ùå ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    showStatus('‚ùå ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                } else {
                    showStatus(`‚ùå ÏÑ†Ìò∏ÎèÑ Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
                }
            }
        }

        // Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú / Delete memory / Supprimer la m√©moire / „É°„É¢„É™ÂâäÈô§ / Âà†Èô§ËÆ∞ÂøÜ
        async function deleteMemory() {
            if (!confirm('Ï†ïÎßêÎ°ú Î™®Îì† Î©îÎ™®Î¶¨Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;

            const config = getConfig();

            try {
                // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (30Ï¥à)
                const timeoutDuration = 30000;
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);
                
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);

                if (response.ok) {
                    showStatus('‚úÖ Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú ÏôÑÎ£å', 'success');
                    memoryStats.style.display = 'none';
                    const memoryDisplay = document.getElementById('memoryDisplay');
                    if (memoryDisplay) memoryDisplay.remove();
                } else {
                    showStatus('‚ùå Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú Ïã§Ìå®', 'error');
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    showStatus('‚ùå Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.', 'error');
                } else {
                    showStatus(`‚ùå Î©îÎ™®Î¶¨ ÏÇ≠Ï†ú Ïã§Ìå®: ${error.message}`, 'error');
                }
            }
        }

        // Í∞êÏ†ï ÏÉÅÌÉú ÌÜµÍ≥Ñ Ï°∞Ìöå / Load emotional stats / Charger les statistiques √©motionnelles / ÊÑüÊÉÖÁµ±Ë®àË™≠„ÅøËæº„Åø / Âä†ËΩΩÊÉÖÊÑüÁªüËÆ°
        async function loadEmotionalStats() {
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/emotions`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    }
                });

                if (response.ok) {
                    const emotionalStats = await response.json();
                    displayEmotionalStats(emotionalStats);
                    showStatus('‚úÖ Í∞êÏ†ï ÏÉÅÌÉú ÌÜµÍ≥Ñ Î°úÎìú ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Í∞êÏ†ï ÏÉÅÌÉú ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Í∞êÏ†ï ÏÉÅÌÉú ÌÜµÍ≥Ñ Î°úÎìú Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Í∞êÏ†ï ÏÉÅÌÉú ÌÜµÍ≥Ñ ÌëúÏãú / Display emotional stats / Afficher les statistiques √©motionnelles / ÊÑüÊÉÖÁµ±Ë®àË°®Á§∫ / ÊòæÁ§∫ÊÉÖÊÑüÁªüËÆ°
        function displayEmotionalStats(stats) {
            const emotionalDisplay = document.createElement('div');
            emotionalDisplay.id = 'emotionalDisplay';
            emotionalDisplay.className = 'memory-item';
            emotionalDisplay.innerHTML = `
                <h4>üòä Í∞êÏ†ï ÏÉÅÌÉú Î∂ÑÏÑù</h4>
                <div class="stat-item">
                    <span>Ï¥ù Í∞êÏ†ï Í∏∞Î°ù:</span>
                    <span class="stat-value">${stats.totalEmotions}</span>
                </div>
                <div class="stat-item">
                    <span>Ï£ºÏöî Í∞êÏ†ï:</span>
                    <span class="stat-value">${stats.dominantEmotion}</span>
                </div>
                <div class="stat-item">
                    <span>Í∞êÏ†ï Î∂ÑÌè¨:</span>
                    <div class="emotion-breakdown">
                        ${Object.entries(stats.emotionBreakdown).map(([emotion, count]) => 
                            `<div class="emotion-item">${emotion}: ${count}</div>`
                        ).join('')}
                    </div>
                </div>
            `;
            
            // Í∏∞Ï°¥ ÌëúÏãú Ï†úÍ±∞
            const existingDisplay = document.getElementById('emotionalDisplay');
            if (existingDisplay) existingDisplay.remove();
            
            memoryStats.appendChild(emotionalDisplay);
            memoryStats.style.display = 'block';
        }

        // Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ Ï°∞Ìöå / Load life timeline / Charger la chronologie de vie / ‰∫∫Áîü„Çø„Ç§„É†„É©„Ç§„É≥Ë™≠„ÅøËæº„Åø / Âä†ËΩΩ‰∫∫ÁîüÊó∂Èó¥Á∫ø
        async function loadTimeline() {
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/timeline`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    }
                });

                if (response.ok) {
                    const timelineData = await response.json();
                    displayTimeline(timelineData.timeline);
                    showStatus('‚úÖ Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ Î°úÎìú ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ Î°úÎìú Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ Î°úÎìú Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏ ÌëúÏãú / Display timeline / Afficher la chronologie / „Çø„Ç§„É†„É©„Ç§„É≥Ë°®Á§∫ / ÊòæÁ§∫Êó∂Èó¥Á∫ø
        function displayTimeline(timeline) {
            const timelineDisplay = document.createElement('div');
            timelineDisplay.id = 'timelineDisplay';
            timelineDisplay.className = 'memory-item';
            
            let timelineHTML = '<h4>üìÖ Ïù∏ÏÉù ÏÇ¨Í±¥ ÌÉÄÏûÑÎùºÏù∏</h4>';
            
            if (timeline.length === 0) {
                timelineHTML += '<p>ÏïÑÏßÅ Í∏∞Î°ùÎêú Ïù∏ÏÉù ÏÇ¨Í±¥Ïù¥ ÏóÜÏäµÎãàÎã§.</p>';
            } else {
                timeline.forEach(event => {
                    const date = new Date(event.timestamp).toLocaleDateString();
                    timelineHTML += `
                        <div class="timeline-event">
                            <div class="event-date">${date}</div>
                            <div class="event-type">${event.type}</div>
                            <div class="event-description">${event.description}</div>
                            <div class="event-emotion">Í∞êÏ†ï: ${event.emotionalImpact}</div>
                        </div>
                    `;
                });
            }
            
            timelineDisplay.innerHTML = timelineHTML;
            
            // Í∏∞Ï°¥ ÌëúÏãú Ï†úÍ±∞
            const existingDisplay = document.getElementById('timelineDisplay');
            if (existingDisplay) existingDisplay.remove();
            
            memoryStats.appendChild(timelineDisplay);
            memoryStats.style.display = 'block';
        }

        // Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù Ï°∞Ìöå / Load context patterns / Charger les mod√®les de contexte / „Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„Éë„Çø„Éº„É≥Ë™≠„ÅøËæº„Åø / Âä†ËΩΩ‰∏ä‰∏ãÊñáÊ®°Âºè
        async function loadPatterns() {
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/patterns`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    }
                });

                if (response.ok) {
                    const patternsData = await response.json();
                    displayPatterns(patternsData.patterns);
                    showStatus('‚úÖ Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù Î°úÎìú ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù Î°úÎìú Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù Î°úÎìú Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù ÌëúÏãú / Display patterns / Afficher les mod√®les / „Éë„Çø„Éº„É≥Ë°®Á§∫ / ÊòæÁ§∫Ê®°Âºè
        function displayPatterns(patterns) {
            const patternsDisplay = document.createElement('div');
            patternsDisplay.id = 'patternsDisplay';
            patternsDisplay.className = 'memory-item';
            
            let patternsHTML = '<h4>üîç Îß•ÎùΩ Ìå®ÌÑ¥ Î∂ÑÏÑù</h4>';
            
            if (patterns.length === 0) {
                patternsHTML += '<p>ÏïÑÏßÅ Î∂ÑÏÑùÎêú Îß•ÎùΩ Ìå®ÌÑ¥Ïù¥ ÏóÜÏäµÎãàÎã§.</p>';
            } else {
                patterns.forEach(pattern => {
                    const date = new Date(pattern.timestamp).toLocaleDateString();
                    patternsHTML += `
                        <div class="pattern-item">
                            <div class="pattern-topics">Ï£ºÏ†ú: ${pattern.topics.join(', ')}</div>
                            <div class="pattern-emotion">Í∞êÏ†ï: ${pattern.emotionalState}</div>
                            <div class="pattern-frequency">ÎπàÎèÑ: ${pattern.frequency}</div>
                            <div class="pattern-date">ÎÇ†Ïßú: ${date}</div>
                        </div>
                    `;
                });
            }
            
            patternsDisplay.innerHTML = patternsHTML;
            
            // Í∏∞Ï°¥ ÌëúÏãú Ï†úÍ±∞
            const existingDisplay = document.getElementById('patternsDisplay');
            if (existingDisplay) existingDisplay.remove();
            
            memoryStats.appendChild(patternsDisplay);
            memoryStats.style.display = 'block';
        }

        // Í¥ÄÍ≥Ñ Ï†ïÎ≥¥ Ï∂îÍ∞Ä / Add relationship / Ajouter une relation / Èñ¢‰øÇÊÄßËøΩÂä† / Ê∑ªÂä†ÂÖ≥Á≥ª
        async function addRelationship() {
            const person = prompt('Í¥ÄÍ≥ÑÎ•º Ï∂îÍ∞ÄÌï† ÏÇ¨ÎûåÏùò Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (!person) return;
            
            const relationship = prompt('Í¥ÄÍ≥ÑÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: ÏπúÍµ¨, Í∞ÄÏ°±, ÎèôÎ£å):');
            if (!relationship) return;
            
            const details = prompt('Ï∂îÍ∞Ä ÏÑ∏Î∂ÄÏÇ¨Ìï≠ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (ÏÑ†ÌÉùÏÇ¨Ìï≠):');
            
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/relationships`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({
                        person: person,
                        relationship: relationship,
                        details: details || {}
                    })
                });

                if (response.ok) {
                    showStatus('‚úÖ Í¥ÄÍ≥Ñ Ï†ïÎ≥¥ Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Í¥ÄÍ≥Ñ Ï†ïÎ≥¥ Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Í¥ÄÍ≥Ñ Ï†ïÎ≥¥ Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Î™©Ìëú Ï∂îÍ∞Ä / Add goal / Ajouter un objectif / ÁõÆÊ®ôËøΩÂä† / Ê∑ªÂä†ÁõÆÊ†á
        async function addGoal() {
            const goal = prompt('Î™©ÌëúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (!goal) return;
            
            const category = prompt('Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: career, health, education):');
            const deadline = prompt('ÎßàÍ∞êÏùºÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî (YYYY-MM-DD, ÏÑ†ÌÉùÏÇ¨Ìï≠):');
            
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/goals`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({
                        goal: goal,
                        category: category || 'general',
                        deadline: deadline || null
                    })
                });

                if (response.ok) {
                    showStatus('‚úÖ Î™©Ìëú Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Î™©Ìëú Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Î™©Ìëú Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Í¥ÄÏã¨ÏÇ¨ Ï∂îÍ∞Ä / Add interest / Ajouter un int√©r√™t / ËààÂë≥ËøΩÂä† / Ê∑ªÂä†ÂÖ¥Ë∂£
        async function addInterest() {
            const interest = prompt('Í¥ÄÏã¨ÏÇ¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (!interest) return;
            
            const category = prompt('Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: hobby, skill, topic):');
            
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/interests`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({
                        interest: interest,
                        category: category || 'general'
                    })
                });

                if (response.ok) {
                    showStatus('‚úÖ Í¥ÄÏã¨ÏÇ¨ Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Í¥ÄÏã¨ÏÇ¨ Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Í¥ÄÏã¨ÏÇ¨ Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Ïû•Í∏∞ Í∏∞Ïñµ Ï∂îÍ∞Ä / Add long-term memory / Ajouter une m√©moire √† long terme / Èï∑ÊúüË®òÊÜ∂ËøΩÂä† / Ê∑ªÂä†ÈïøÊúüËÆ∞ÂøÜ
        async function addLongTermMemory() {
            const memory = prompt('Ïû•Í∏∞ Í∏∞ÏñµÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî:');
            if (!memory) return;
            
            const category = prompt('Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (Ïòà: experience, achievement, lesson):');
            const importance = prompt('Ï§ëÏöîÎèÑÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî (high, medium, low):');
            
            const config = getConfig();

            try {
                const response = await fetch(`${config.apiUrl}/api/memory/${config.userId}/longterm`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({
                        memory: memory,
                        category: category || 'general',
                        importance: importance || 'medium'
                    })
                });

                if (response.ok) {
                    showStatus('‚úÖ Ïû•Í∏∞ Í∏∞Ïñµ Ï∂îÍ∞Ä ÏôÑÎ£å', 'success');
                } else {
                    showStatus('‚ùå Ïû•Í∏∞ Í∏∞Ïñµ Ï∂îÍ∞Ä Ïã§Ìå®', 'error');
                }
            } catch (error) {
                showStatus(`‚ùå Ïû•Í∏∞ Í∏∞Ïñµ Ï∂îÍ∞Ä Ïã§Ìå®: ${error.message}`, 'error');
            }
        }

        // Î©îÏãúÏßÄ Ï∂îÍ∞Ä / Add message / Ajouter un message / „É°„ÉÉ„Çª„Éº„Ç∏ËøΩÂä† / Ê∑ªÂä†Ê∂àÊÅØ
        function addMessage(role, content, showRetry = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            
            const header = document.createElement('div');
            header.className = 'message-header';
            header.textContent = role === 'user' ? 'ÏÇ¨Ïö©Ïûê' : role === 'assistant' ? 'AI' : 'ÏãúÏä§ÌÖú';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            contentDiv.textContent = content;
            
            messageDiv.appendChild(header);
            messageDiv.appendChild(contentDiv);
            
            // Ïû¨ÏãúÎèÑ Î≤ÑÌäº Ï∂îÍ∞Ä (ÏãúÏä§ÌÖú Î©îÏãúÏßÄÏù¥Í≥† showRetryÍ∞Ä trueÏù∏ Í≤ΩÏö∞)
            if (role === 'system' && showRetry) {
                const retryButton = document.createElement('button');
                retryButton.className = 'retry-button';
                retryButton.textContent = 'üîÑ Ïû¨ÏãúÎèÑ';
                retryButton.onclick = () => {
                    messageDiv.remove();
                    sendMessage();
                };
                messageDiv.appendChild(retryButton);
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Î©îÏãúÏßÄ Ï†ÑÏÜ° / Send message / Envoyer un message / ÈÄÅ‰ø° / ÂèëÈÄÅÊ∂àÊÅØ
        async function sendMessage() {
            const message = messageInput.value.trim();
            if (!message) return;

            const config = getConfig();
            
            // ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄ ÌëúÏãú
            addMessage('user', message);
            messageInput.value = '';

            // Î°úÎî© ÌëúÏãú
            loading.style.display = 'block';
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // ÌÉÄÏûÑÏïÑÏõÉ ÏÑ§Ï†ï (ÏÇ¨Ïö©Ïûê ÏÑ§Ï†ïÍ∞í ÏÇ¨Ïö©)
            const timeoutDuration = config.timeout * 1000;
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeoutDuration);

            // ÌÉÄÏûÑÏïÑÏõÉÏùò 1/3 ÏßÄÏ†êÏóêÏÑú Í≤ΩÍ≥† Î©îÏãúÏßÄ ÌëúÏãú
            const warningTimeout = setTimeout(() => {
                if (loading.style.display !== 'none') {
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    showStatus(t.responseDelay, 'info');
                }
            }, timeoutDuration / 3);

            try {
                const response = await fetch(`${config.apiUrl}/v1/chat/completions`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${config.apiKey}`,
                        'Content-Type': 'application/json; charset=utf-8'
                    },
                    body: JSON.stringify({
                        model: config.model,
                        messages: [{ role: 'user', content: message }],
                        temperature: 0.7,
                        user_id: config.userId
                    }),
                    signal: controller.signal
                });

                // ÌÉÄÏûÑÏïÑÏõÉ Ï∑®ÏÜå
                clearTimeout(timeoutId);
                clearTimeout(warningTimeout);

                if (response.ok) {
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    addMessage('assistant', aiResponse);
                    
                    // Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏
                    setTimeout(() => loadMemoryStats(), 1000);
                } else {
                    const errorData = await response.json();
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    addMessage('system', `${t.unknownError}: ${errorData.error?.message || t.unknownError}`);
                }
            } catch (error) {
                if (error.name === 'AbortError') {
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    addMessage('system', t.timeoutError, true);
                    addMessage('system', t.timeoutSolutions, true);
                    addMessage('system', t.computerRequirements, true);
                } else {
                    const currentLang = document.getElementById('languageSelect').value;
                    const t = i18n[currentLang] || i18n.en;
                    addMessage('system', t.connectionError.replace('{error}', error.message), true);
                }
            } finally {
                clearTimeout(warningTimeout);
                loading.style.display = 'none';
            }
        }

        // ÏóîÌÑ∞ÌÇ§ Ï≤òÎ¶¨ / Handle Enter key / G√©rer Entr√©e / „Ç®„É≥„Çø„ÉºÂá¶ÁêÜ / Â§ÑÁêÜÂõûËΩ¶
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî / Initialize on load / Initialiser au chargement / Ë™≠„ÅøËæº„ÅøÊôÇÂàùÊúüÂåñ / È°µÈù¢Âä†ËΩΩÂàùÂßãÂåñ
        window.onload = function() {
            // ÏÇ¨Ïö©Ïûê ID Î≥ÄÍ≤Ω Ïãú Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ Î°úÎìú
            userIdInput.addEventListener('change', loadMemoryStats);
            // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Ïãú Î≤àÏó≠ Ï†ÅÏö© / Apply i18n when language changes
            const languageSelect = document.getElementById('languageSelect');
            languageSelect.addEventListener('change', (e) => applyTranslations(e.target.value));
            
            // Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            document.getElementById('refreshModelsBtn').addEventListener('click', loadModels);
            document.getElementById('testConnectionBtn').addEventListener('click', testConnection);
            document.getElementById('loadMemoryStatsBtn').addEventListener('click', loadMemoryStats);
            document.getElementById('loadUserMemoryBtn').addEventListener('click', loadUserMemory);
            document.getElementById('addFactBtn').addEventListener('click', addFact);
            document.getElementById('addPreferenceBtn').addEventListener('click', addPreference);
            document.getElementById('deleteMemoryBtn').addEventListener('click', deleteMemory);
            document.getElementById('sendMessageBtn').addEventListener('click', sendMessage);
            
            // Í≥†Í∏â Î©îÎ™®Î¶¨ Í∏∞Îä• Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            document.getElementById('loadEmotionalStatsBtn').addEventListener('click', loadEmotionalStats);
            document.getElementById('loadTimelineBtn').addEventListener('click', loadTimeline);
            document.getElementById('loadPatternsBtn').addEventListener('click', loadPatterns);
            document.getElementById('addRelationshipBtn').addEventListener('click', addRelationship);
            document.getElementById('addGoalBtn').addEventListener('click', addGoal);
            document.getElementById('addInterestBtn').addEventListener('click', addInterest);
            document.getElementById('addLongTermMemoryBtn').addEventListener('click', addLongTermMemory);
            
            // Ï¥àÍ∏∞ Î™®Îç∏ Î™©Î°ù Î°úÎìú
            setTimeout(loadModels, 500);
            
            // Ï¥àÍ∏∞ Î©îÎ™®Î¶¨ ÌÜµÍ≥Ñ Î°úÎìú
            setTimeout(loadMemoryStats, 1000);

            // Í∏∞Î≥∏ Ïñ∏Ïñ¥ Ï†ÅÏö© (ÏòÅÏñ¥) / Apply default language (English)
            applyTranslations('en');
        };
    </script>
</body>
</html> 